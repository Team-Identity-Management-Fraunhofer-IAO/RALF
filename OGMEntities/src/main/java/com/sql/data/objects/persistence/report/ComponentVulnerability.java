package com.sql.data.objects.persistence.report;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.IdClass;
import javax.persistence.Table;

import com.sql.data.objects.persistence.vulnerabilities.CVECore;
import com.sql.data.objects.persistence.vulnerabilities.Description;

@Entity
@IdClass(ComponentVulnerabilityPK.class)
@Table(name="componentVulnerability")
public class ComponentVulnerability {

	private int vulnCompID;
	private int cveYear;
	private int cveID;
	private String identifierString;
	private String vectorString;
	private String attackVector;
	private String attackComplexity;
	private String privilegesRequired;
	private String userInteraction;
	private String scope;
	private String confidentialityImpact;
	private String integrityImpact;
	private String availabilityImpact;
	private float baseScore;
	private String baseSeverity;
	private float exploitabilityScore;
	private float impactScore;
	private String descriptionText;
	private String uri;
	
	public ComponentVulnerability() {
		
	}

	@Id
	@Column(name="vulnCompID", nullable=false)
	public int getVulnCompID() {
		return vulnCompID;
	}

	public void setVulnCompID(int vulnCompID) {
		this.vulnCompID = vulnCompID;
	}

	@Id
	@Column(name="cveYear", nullable=false)
	public int getCveYear() {
		return cveYear;
	}

	public void setCveYear(int cveYear) {
		this.cveYear = cveYear;
	}

	@Id
	@Column(name="cveID", nullable=false)
	public int getCveID() {
		return cveID;
	}

	public void setCveID(int cveID) {
		this.cveID = cveID;
	}

	@Column(name="identifierString", nullable=false)
	public String getIdentifierString() {
		return identifierString;
	}

	public void setIdentifierString(String identifierString) {
		this.identifierString = identifierString;
	}

	@Column(name="vectorString", nullable=false)
	public String getVectorString() {
		return vectorString;
	}

	public void setVectorString(String vectorString) {
		this.vectorString = vectorString;
	}

	@Column(name="attackVector", nullable=false)
	public String getAttackVector() {
		return attackVector;
	}

	public void setAttackVector(String attackVector) {
		this.attackVector = attackVector;
	}

	@Column(name="attackComplexity", nullable=false)
	public String getAttackComplexity() {
		return attackComplexity;
	}

	public void setAttackComplexity(String attackComplexity) {
		this.attackComplexity = attackComplexity;
	}

	@Column(name="privilegesRequired", nullable=false)
	public String getPrivilegesRequired() {
		return privilegesRequired;
	}

	public void setPrivilegesRequired(String privilegesRequired) {
		this.privilegesRequired = privilegesRequired;
	}

	@Column(name="userInteraction", nullable=false)
	public String getUserInteraction() {
		return userInteraction;
	}

	public void setUserInteraction(String userInteraction) {
		this.userInteraction = userInteraction;
	}

	@Column(name="scope", nullable=false)
	public String getScope() {
		return scope;
	}

	public void setScope(String scope) {
		this.scope = scope;
	}

	@Column(name="confidentialityImpact", nullable=false)
	public String getConfidentialityImpact() {
		return confidentialityImpact;
	}

	public void setConfidentialityImpact(String confidentialityImpact) {
		this.confidentialityImpact = confidentialityImpact;
	}

	@Column(name="integrityImpact", nullable=false)
	public String getIntegrityImpact() {
		return integrityImpact;
	}

	public void setIntegrityImpact(String integrityImpact) {
		this.integrityImpact = integrityImpact;
	}

	@Column(name="availabilityImpact", nullable=false)
	public String getAvailabilityImpact() {
		return availabilityImpact;
	}

	public void setAvailabilityImpact(String availabilityImpact) {
		this.availabilityImpact = availabilityImpact;
	}

	@Column(name="baseScore", nullable=false)
	public float getBaseScore() {
		return baseScore;
	}

	public void setBaseScore(float baseScore) {
		this.baseScore = baseScore;
	}

	@Column(name="baseSeverity", nullable=false)
	public String getBaseSeverity() {
		return baseSeverity;
	}

	public void setBaseSeverity(String baseSeverity) {
		this.baseSeverity = baseSeverity;
	}

	@Column(name="exploitabilityScore", nullable=false)
	public float getExploitabilityScore() {
		return exploitabilityScore;
	}

	public void setExploitabilityScore(float exploitabilityScore) {
		this.exploitabilityScore = exploitabilityScore;
	}

	@Column(name="impactScore", nullable=false)
	public float getImpactScore() {
		return impactScore;
	}

	public void setImpactScore(float impactScore) {
		this.impactScore = impactScore;
	}

	@Column(name="descriptionText", nullable=false)
	public String getDescriptionText() {
		return descriptionText;
	}

	public void setDescriptionText(String descriptionText) {
		this.descriptionText = descriptionText;
	}

	@Column(name="uri", nullable=false)
	public String getUri() {
		return uri;
	}

	public void setUri(String uri) {
		this.uri = uri;
	}
	
	public void constructFromVulnerability(CVECore vuln) {
		this.cveYear = vuln.getCveYear();
		this.cveID = vuln.getCveID();
		this.identifierString = vuln.getIdentifierString()==null?"TBD":vuln.getIdentifierString();
		this.vectorString = vuln.getVectorString()==null?"TBD":vuln.getVectorString();
		this.attackVector = vuln.getAttackVector()==null?"TBD":vuln.getAttackVector();
		this.attackComplexity = vuln.getAttackComplexity()==null?"TBD":vuln.getAttackComplexity();
		this.privilegesRequired = vuln.getPrivilegesRequired()==null?"TBD":vuln.getPrivilegesRequired();
		this.userInteraction = vuln.getUserInteraction()==null?"TBD":vuln.getUserInteraction();
		this.scope = vuln.getScope()==null?"TBD":vuln.getScope();
		this.confidentialityImpact = vuln.getConfidentialityImpact()==null?"TBD":vuln.getConfidentialityImpact();
		this.integrityImpact = vuln.getIntegrityImpact()==null?"TBD":vuln.getIntegrityImpact();
		this.availabilityImpact = vuln.getAvailabilityImpact()==null?"TBD":vuln.getAvailabilityImpact();
		this.baseScore = vuln.getBaseScore();
		this.baseSeverity = vuln.getBaseSeverity()==null?"TBD":vuln.getBaseSeverity();
		this.exploitabilityScore = vuln.getExploitabilityScore();
		this.impactScore = vuln.getImpactScore();
	}
	
	public void constructFromDescription(Description description) {
		if (this.descriptionText == null) {
		this.descriptionText = description.getDescriptionText();
		}else {
			this.descriptionText += "\r\n"+description.getDescriptionText();
		}
	}
	
}
