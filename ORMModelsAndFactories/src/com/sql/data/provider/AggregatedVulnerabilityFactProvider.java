package com.sql.data.provider;

import java.util.List;

import org.hibernate.Session;
import org.hibernate.query.NativeQuery;

import com.sql.data.objects.persistence.report.AggregatedVulnerabilityFact;

public class AggregatedVulnerabilityFactProvider extends PersistenceObjectProvider<AggregatedVulnerabilityFact> implements PersistenceObjectProviderService<AggregatedVulnerabilityFact>{

	@Override
	public Class<AggregatedVulnerabilityFact> getClassName() {
		return AggregatedVulnerabilityFact.class;
	}
	
	public List<AggregatedVulnerabilityFact> getAggregatedVulnerabilityFactByReportID(int reportID){
		super.instantiateHibernateReportingSessionFactory();
		String sql = "SELECT * FROM aggregatedvulnerabilityfact WHERE reportID = :reportID";
		Session session = super.hibernateSessionFactory.openSession();
		NativeQuery<AggregatedVulnerabilityFact> query = session.createNativeQuery(sql, AggregatedVulnerabilityFact.class);
		query.setParameter("reportID", reportID);
		List<AggregatedVulnerabilityFact> result = query.list();
		session.close();
		return result;
	}

}
